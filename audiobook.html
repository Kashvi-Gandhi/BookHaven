<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audiobooks - BookHaven</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .audiobook-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 80px 0 60px;
            color: white;
            text-align: center;
        }

        .audiobook-hero h1 {
            font-size: 3rem;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .filter-section {
            background: #f8f9fa;
            padding: 30px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .filter-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #4285f4;
            background: white;
            color: #4285f4;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .filter-btn:hover, .filter-btn.active {
            background: #4285f4;
            color: white;
        }

        .audiobooks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            padding: 50px 0;
        }

        .audiobook-item {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .audiobook-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .audiobook-cover-container {
            position: relative;
            width: 100%;
            padding-top: 100%;
            background: #f0f0f0;
            overflow: hidden;
        }

        .audiobook-cover-container img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .audiobook-item:hover .play-overlay {
            opacity: 1;
        }

        .play-overlay i {
            font-size: 60px;
            color: white;
        }

        .audiobook-details {
            padding: 20px;
        }

        .category-badge {
            display: inline-block;
            padding: 5px 12px;
            background: #e3f2fd;
            color: #1976d2;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .audiobook-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #f0f0f0;
        }

        .player-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            overflow-y: auto;
        }

        .player-content {
            position: relative;
            max-width: 800px;
            margin: 5vh auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
        }

        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .close-player {
            font-size: 2rem;
            color: #666;
            cursor: pointer;
            background: none;
            border: none;
        }

        .audio-player {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
        }

        .part-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .part-btn {
            padding: 10px 20px;
            background: white;
            border: 2px solid #4285f4;
            color: #4285f4;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .part-btn.active {
            background: #4285f4;
            color: white;
        }

        .progress-bar-audio {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .progress-bar-audio .progress {
            height: 100%;
            background: #4285f4;
            width: 0%;
            transition: width 0.1s linear;
        }

        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: #4285f4;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #3367d6;
            transform: scale(1.1);
        }

        .control-btn.play {
            width: 60px;
            height: 60px;
        }

        @media (max-width: 768px) {
            .audiobooks-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
            
            .player-content {
                margin: 2vh auto;
                padding: 20px;
                max-width: 95%;
            }
        }
    </style>
</head>
<body>
    <header style="position: sticky; top: 0; z-index: 1000;">
        <div class="container">
            <div class="header-content" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 0;">
                <div class="logo" style="display: flex; align-items: center; font-size: 1.5rem; font-weight: bold; color: white;">
                    <i class="fas fa-headphones" style="margin-right: 10px;"></i>
                    <span>BookHaven Audiobooks</span>
                </div>
                <nav>
                    <ul style="display: flex; list-style: none; margin: 0; padding: 0;">
                        <li style="margin-left: 1.5rem;"><a href="index.html" style="color: white; text-decoration: none;">Home</a></li>
                        <li style="margin-left: 1.5rem;"><a href="#" style="color: white; text-decoration: none;">Browse</a></li>
                        <li style="margin-left: 1.5rem;"><a href="#" class="active" style="color: #aed6f1; text-decoration: none;">Audiobooks</a></li>
                        <li style="margin-left: 1.5rem;"><a href="#" style="color: white; text-decoration: none;">My Library</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <section class="audiobook-hero">
        <div class="container">
            <h1>Discover Amazing Audiobooks</h1>
            <p>Immerse yourself in captivating stories narrated by professional voice actors. Listen anywhere, anytime.</p>
        </div>
    </section>

    <section class="filter-section">
        <div class="container">
            <div class="filter-controls">
                <div class="filter-group">
                    <button class="filter-btn active">All</button>
                    <button class="filter-btn">Fiction</button>
                    <button class="filter-btn">Non-Fiction</button>
                    <button class="filter-btn">Mystery</button>
                    <button class="filter-btn">Romance</button>
                    <button class="filter-btn">Sci-Fi</button>
                </div>
                <div class="search-filter">
                    <input type="text" placeholder="Search audiobooks..." style="flex: 1; padding: 10px 15px; border: 2px solid #e0e0e0; border-radius: 25px;">
                    <button style="padding: 10px 25px; background: #4285f4; color: white; border: none; border-radius: 25px; cursor: pointer;"><i class="fas fa-search"></i></button>
                </div>
            </div>
        </div>
    </section>

    <section class="audiobooks">
        <div class="container">
            <div class="audiobooks-grid">
                <div class="audiobook-item" onclick="openAudioPlayer('love-friendship', 'Love and Friendship', 'Jane Austen')">
                    <div class="audiobook-cover-container">
                        <img src="./images/love&friendship.jpg" alt="Love and Friendship">
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="audiobook-details">
                        <div class="category-badge">Romance</div>
                        <h3>Love and Friendship</h3>
                        <p class="author">Jane Austen</p>
                        <div class="audiobook-meta">
                            <div class="duration">
                                <i class="fas fa-clock"></i>
                                <span>2h 45m</span>
                            </div>
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.5</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="audiobook-item" onclick="openAudioPlayer('great-gatsby', 'The Great Gatsby', 'F. Scott Fitzgerald')">
                    <div class="audiobook-cover-container">
                        <img src="./icons/TGG1.jpg" alt="The Great Gatsby">
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="audiobook-details">
                        <div class="category-badge">Classic</div>
                        <h3>The Great Gatsby</h3>
                        <p class="author">F. Scott Fitzgerald</p>
                        <div class="audiobook-meta">
                            <div class="duration">
                                <i class="fas fa-clock"></i>
                                <span>4h 20m</span>
                            </div>
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.8</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="audiobook-item" onclick="openAudioPlayer('meditations', 'Meditations', 'Marcus Aurelius')">
                    <div class="audiobook-cover-container">
                        <img src="./icons/M.webp" alt="Meditations">
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="audiobook-details">
                        <div class="category-badge">Philosophy</div>
                        <h3>Meditations</h3>
                        <p class="author">Marcus Aurelius</p>
                        <div class="audiobook-meta">
                            <div class="duration">
                                <i class="fas fa-clock"></i>
                                <span>3h 15m</span>
                            </div>
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.9</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="audiobook-item" onclick="openAudioPlayer('beyond-horizon', 'Beyond the Horizon', 'K J Cloutier')">
                    <div class="audiobook-cover-container">
                        <img src="./icons/BTH.jpg" alt="Beyond the Horizon">
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="audiobook-details">
                        <div class="category-badge">Adventure</div>
                        <h3>Beyond the Horizon</h3>
                        <p class="author">K J Cloutier</p>
                        <div class="audiobook-meta">
                            <div class="duration">
                                <i class="fas fa-clock"></i>
                                <span>5h 30m</span>
                            </div>
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.3</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="audiobook-item" onclick="openAudioPlayer('whispers-dark', 'Whispers in the Dark', 'Georgette St Clair')">
                    <div class="audiobook-cover-container">
                        <img src="./icons/WD.jpg" alt="Whispers in the Dark">
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="audiobook-details">
                        <div class="category-badge">Mystery</div>
                        <h3>Whispers in the Dark</h3>
                        <p class="author">Georgette St Clair</p>
                        <div class="audiobook-meta">
                            <div class="duration">
                                <i class="fas fa-clock"></i>
                                <span>6h 45m</span>
                            </div>
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.7</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="audiobook-item" onclick="openAudioPlayer('philosopher-journey', 'The Philosopher\'s Journey', 'Lab Maharaj')">
                    <div class="audiobook-cover-container">
                        <img src="./icons/TPJ.jpg" alt="The Philosopher's Journey">
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="audiobook-details">
                        <div class="category-badge">Philosophy</div>
                        <h3>The Philosopher's Journey</h3>
                        <p class="author">Lab Maharaj</p>
                        <div class="audiobook-meta">
                            <div class="duration">
                                <i class="fas fa-clock"></i>
                                <span>4h 15m</span>
                            </div>
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.6</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="audio-player-modal" class="player-modal">
        <div class="player-content">
            <div class="player-header">
                <h2 id="player-title">Audiobook Title</h2>
                <button class="close-player" onclick="closeAudioPlayer()">&times;</button>
            </div>
            
            <div class="player-cover" style="text-align: center; margin-bottom: 30px;">
                <img id="player-cover" src="" alt="Audiobook Cover" style="max-width: 300px; border-radius: 15px;">
            </div>
            
            <div class="player-info" style="text-align: center; margin-bottom: 30px;">
                <h3 id="player-book-title">Book Title</h3>
                <p class="author" id="player-author">Author Name</p>
            </div>
            
            <div class="audio-player">
                <div class="part-selector">
                    <button class="part-btn active" onclick="selectPart(1)">Part 1</button>
                    <button class="part-btn" onclick="selectPart(2)">Part 2</button>
                    <button class="part-btn" onclick="selectPart(3)">Part 3</button>
                </div>
                
                <audio id="audio-element" controls style="width: 100%; margin-bottom: 20px;">
                    <source id="audio-source" src="" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
                
                <div class="progress-container" style="margin-bottom: 20px;">
                    <div class="progress-bar-audio" onclick="seekAudio(event)">
                        <div class="progress" id="audio-progress"></div>
                    </div>
                    <div class="time-info" style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #666; margin-top: 8px;">
                        <span id="current-time">0:00</span>
                        <span id="total-time">0:00</span>
                    </div>
                </div>
                
                <div class="player-controls">
                    <button class="control-btn" onclick="previousTrack()">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="control-btn" onclick="rewind()">
                        <i class="fas fa-backward"></i>
                    </button>
                    <button class="control-btn play" id="play-pause-btn" onclick="togglePlayPause()">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="control-btn" onclick="fastForward()">
                        <i class="fas fa-forward"></i>
                    </button>
                    <button class="control-btn" onclick="nextTrack()">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    <select class="speed-control" id="speed-control" onchange="changeSpeed()" style="margin-left: 20px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                        <option value="0.5">0.5x</option>
                        <option value="0.75">0.75x</option>
                        <option value="1" selected>1x</option>
                        <option value="1.25">1.25x</option>
                        <option value="1.5">1.5x</option>
                        <option value="2">2x</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if user is logged in
        document.addEventListener('DOMContentLoaded', function() {
            const userLoggedIn = localStorage.getItem('userLoggedIn');
            if (userLoggedIn !== 'true') {
                alert('Without login you could not access audiobook');
                window.location.href = 'index.html';
                return;
            }
            
            // Initialize audio player if user is logged in
            initializeAudioPlayer();
        });

        let currentAudiobook = null;
        let currentPart = 1;
        let isPlaying = false;

        const audiobooks = {
            'love-friendship': {
                title: 'Love and Friendship',
                author: 'Jane Austen',
                cover: './images/love&friendship.jpg',
                parts: [
                    './audio_book/love-freindship_1_austen_64kb.mp3',
                    './audio_book/love-freindship_2_austen_64kb.mp3',
                    './audio_book/love-freindship_3_austen_64kb.mp3'
                ]
            },
            'great-gatsby': {
                title: 'The Great Gatsby',
                author: 'F. Scott Fitzgerald',
                cover: './icons/TGG1.jpg',
                parts: [
                    './audio_book/love-freindship_1_austen_64kb.mp3',
                    './audio_book/love-freindship_2_austen_64kb.mp3',
                    './audio_book/love-freindship_3_austen_64kb.mp3'
                ]
            },
            'meditations': {
                title: 'Meditations',
                author: 'Marcus Aurelius',
                cover: './icons/M.webp',
                parts: [
                    './audio_book/love-freindship_1_austen_64kb.mp3',
                    './audio_book/love-freindship_2_austen_64kb.mp3',
                    './audio_book/love-freindship_3_austen_64kb.mp3'
                ]
            }
        };

        function openAudioPlayer(audiobookId, title, author) {
            currentAudiobook = audiobookId;
            currentPart = 1;
            
            const audiobook = audiobooks[audiobookId] || {
                title: title,
                author: author,
                cover: './icons/81wzd1wT-5L._UF1000,1000_QL80_.jpg',
                parts: ['./audio_book/love-freindship_1_austen_64kb.mp3']
            };
            
            document.getElementById('player-title').textContent = audiobook.title;
            document.getElementById('player-book-title').textContent = audiobook.title;
            document.getElementById('player-author').textContent = audiobook.author;
            document.getElementById('player-cover').src = audiobook.cover;
            
            loadAudioPart(1);
            document.getElementById('audio-player-modal').style.display = 'block';
        }

        function closeAudioPlayer() {
            const audio = document.getElementById('audio-element');
            audio.pause();
            isPlaying = false;
            updatePlayButton();
            document.getElementById('audio-player-modal').style.display = 'none';
        }

        function loadAudioPart(partNumber) {
            if (!currentAudiobook || !audiobooks[currentAudiobook]) return;
            
            const audiobook = audiobooks[currentAudiobook];
            const audio = document.getElementById('audio-element');
            const source = document.getElementById('audio-source');
            
            if (audiobook.parts && audiobook.parts[partNumber - 1]) {
                source.src = audiobook.parts[partNumber - 1];
                audio.load();
            }
            
            document.querySelectorAll('.part-btn').forEach((btn, index) => {
                btn.classList.toggle('active', index + 1 === partNumber);
            });
        }

        function selectPart(partNumber) {
            currentPart = partNumber;
            loadAudioPart(partNumber);
        }

        function togglePlayPause() {
            const audio = document.getElementById('audio-element');
            
            if (isPlaying) {
                audio.pause();
            } else {
                audio.play();
            }
            
            isPlaying = !isPlaying;
            updatePlayButton();
        }

        function updatePlayButton() {
            const playBtn = document.getElementById('play-pause-btn');
            const icon = playBtn.querySelector('i');
            
            if (isPlaying) {
                icon.className = 'fas fa-pause';
            } else {
                icon.className = 'fas fa-play';
            }
        }

        function previousTrack() {
            if (currentPart > 1) {
                selectPart(currentPart - 1);
            }
        }

        function nextTrack() {
            const maxParts = audiobooks[currentAudiobook]?.parts?.length || 3;
            if (currentPart < maxParts) {
                selectPart(currentPart + 1);
            }
        }

        function rewind() {
            const audio = document.getElementById('audio-element');
            audio.currentTime = Math.max(0, audio.currentTime - 10);
        }

        function fastForward() {
            const audio = document.getElementById('audio-element');
            audio.currentTime = Math.min(audio.duration, audio.currentTime + 10);
        }

        function changeSpeed() {
            const audio = document.getElementById('audio-element');
            const speed = document.getElementById('speed-control').value;
            audio.playbackRate = parseFloat(speed);
        }

        function seekAudio(event) {
            const audio = document.getElementById('audio-element');
            const progressBar = event.currentTarget;
            const rect = progressBar.getBoundingClientRect();
            const percent = (event.clientX - rect.left) / rect.width;
            audio.currentTime = percent * audio.duration;
        }

        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return minutes + ':' + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;
        }

        // Event listeners - moved to the main DOMContentLoaded above
        function initializeAudioPlayer() {
            const audio = document.getElementById('audio-element');
            
            audio.addEventListener('timeupdate', function() {
                const progress = (audio.currentTime / audio.duration) * 100;
                document.getElementById('audio-progress').style.width = progress + '%';
                
                document.getElementById('current-time').textContent = formatTime(audio.currentTime);
                document.getElementById('total-time').textContent = formatTime(audio.duration);
            });
            
            audio.addEventListener('ended', function() {
                nextTrack();
            });

            // Filter functionality
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const category = this.textContent.toLowerCase();
                    filterAudiobooks(category);
                });
            });
        }

        function filterAudiobooks(category) {
            const audiobooks = document.querySelectorAll('.audiobook-item');
            
            audiobooks.forEach(book => {
                const bookCategory = book.querySelector('.category-badge').textContent.toLowerCase();
                
                if (category === 'all' || bookCategory === category) {
                    book.style.display = 'block';
                } else {
                    book.style.display = 'none';
                }
            });
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('audio-player-modal');
            if (event.target === modal) {
                closeAudioPlayer();
            }
        });
    </script>
</body>
</html>